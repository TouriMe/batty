<div class="payment_wrapper row">

  <div class="form_wrapper large-8 small-12 columns">

    <%= form_for(@purchase, remote: true, url: {action: "create"}, html: {id: "payment_details"}) do |f| %>
        <div id="payment_detail">
          <div class="header">
            <label><h3>Booking Details</h3></label>
          </div>

          <%= f.hidden_field :purchasable_id, value: @trip.id %>
          <%= f.hidden_field :purchasable_type, value: "Tour" %>

          <%= f.hidden_field :price, value: @price %>
          <%= f.hidden_field :reference_id, value: @reference_id %>

          <%= f.hidden_field :transport_price, value: @transport_price %>
          <%= f.hidden_field :ticket_price, value: @ticket_price %>

          <div class="row">
            <div class="form-group small-12 medium-6 columns">
              <%= f.label :start_date, "Start Date" %>
              <%= f.text_field :start_date, id: "startdate", :required => "", placeholder: 'Please enter Start Date' %>
            </div>

            <div class="form-group small-12 medium-6 columns">
              <%= f.label :address_id, "Pick Up Address" %>
              <!--<%= f.collection_select(:address_id, Address.all, :id, :name, {:prompt => 'Please select Pickup Address', :selected => @purchase.address_id}) %>-->
              <%= f.text_field :pickup, id: "address_id", :required => "", placeholder: 'Please enter Pick Up Address' %>
            </div>

            <div class="form-group small-12 medium-6 columns">
              <%= f.label :pickup_time, "Pick Up Time" %>
              <%= f.text_field :pickup_time, id: "pickuptime", :required => "", placeholder: 'Please enter Pick Up Time ( eg:8am )' %>
            </div>

            <div class="form-group small-12 medium-6 columns">
              <%= f.label :traveller_number, "No. of Travellers" %>
              <%= f.select :traveller_number, [['1', 1], ['2', 2], ['3', 3], ['4', 4], ['5', 5], ['6', 6], ['7', 7], ['8', 8]], {}, \
               {:onChange => 'updatePrice(this);'} %>
            </div>

          </div>

          <div class="header">
            <label><h3>Traveller Details</h3></label>
          </div>
          <div class="row">
            <div class="form-group small-12 medium-6 columns">
              <%= f.label :first_name, "First Name" %>
              <%= f.text_field :first_name, :required => "", placeholder: 'Please enter First Name' %>
            </div>

            <div class="form-group small-12 medium-6 columns">
              <%= f.label :last_name, "Last Name" %>
              <%= f.text_field :last_name, :required => "", placeholder: 'Please enter Last Name' %>
            </div>
            <!--<div class="form-group small-12 medium-6 columns">-->
            <!--<%= f.label :passport_number, "Passport Number" %>-->
            <!--<%= f.text_field :passport_number, :required => "", placeholder: 'Please enter Passport Number' %>-->
            <!--</div>-->
            <div class="form-group small-12 medium-6 columns">
              <%= f.label :nationality, "Nationality" %>
              <%= f.text_field :nationality, :required => "", placeholder: 'Please enter Nationality' %>
            </div>

            <div class="form-group small-12 medium-6 columns">
              <%= f.label :email, "Email" %>
              <%= f.email_field :email, :required => "", placeholder: 'Please enter Email' %>
            </div>

            <!--<div class="form-group small-12 medium-6 columns">-->
            <!--<%= f.label :email_confirmation, "Confirm Your Email" %>-->
            <!--<%= f.email_field :email_confirmation, :required => "", placeholder: 'Please confirm Your Email' %>-->
            <!--</div>-->

            <div class="form-group columns">
              <%= f.label :phone_number, "Phone Number", class: 'phone-label' %>
              <%= f.text_field :country_code, id: "country_code", placeholder: '+country code' %>
              <%= f.text_field :phone_number, id: "phone_number", placeholder: 'Phone number' %>
            </div>

            <div class="form-group small-12 columns">
              <%= f.label :comments, "Your Comment" %>
              <%= f.text_area :comments %>
            </div>
          </div>
        </div>
    <% end %>

    <br/>

    <h2>Payment</h2>

    <div class="row payment_box_wrapper">
      <div class="large-6 columns paypal_wrapper">
        <p>Pay With Paypal</p>
        <div id="paypal-container"></div>
      </div>

      <div class="large-6 columns cards_wrapper">
        <p>Pay With Cards</p>
        <a href="#" id="cards_toggle">
          <%= image_tag("paymentcards.png", class: "paymentCards") %>
        </a>
      </div>

    </div>

    <div class="payment_btn" id="card_payment">

    </div>

    <%= form_tag('/checkout', method: "get", id: "payment_form") do %>
        <div id="payment_form_go">
          <div id="card_details">
            <div class="form-group">
              <label for="card-number">Card Number</label>
              <div id="card-number">
              </div>
            </div>

            <div class="form-group">
              <label for="expiration-date">Expiration Date</label>
              <div id="expiration-date">
              </div>
            </div>

            <div class="form-group">
              <label for="cvv">Security Code</label>
              <div id="cvv">
              </div>
            </div>
          </div>

          <div class="form-group info">
            <p>By clicking on “Confirm Payment”, you agree to pay the total amount shown, which includes
              Service Fees on the right and to the Terms of Service, Cancellation Policy and Refund Policy.</p>
          </div>

          <div class="form-group">
            <%= submit_tag("Confirm Payment", id: "bt_charge", onclick: "clicked_chargebt()") %>
          </div>
        </div>
    <% end %>

  </div>

  <div class="large-4 payment_info small-12 columns">
    <div class="box_wrapper">
      <header id="info_top">
        <h4><%= @trip.name %></h4>
        <section id="bill_info">
          <table class="table">
            <tbody>
            <% if @trip.ticket_price_cents > 0 %>
                <tr>
                  <td>Ticket Price</td>
                  <td class="charge"><%= number_to_currency(@ticket_price, :precision => 0) %>
                    (USD) &nbsp; X &nbsp; <strong><span id="tourist_no">1</span></strong></td>
                </tr>
            <% end %>
            <tr>
              <td>Transport(Tuk Tuk)</td>
              <td class="charge"><%= number_to_currency(@transport_price, :precision => 0) %>
                (USD) &nbsp; X &nbsp;<strong><span id="vehicle_no">1</span></strong></td>
            </tr>
            </tbody>
          </table>
          <h2>Total <span id="total_charge"><%= @online_pay %></span> $</h2>
          <p class="meta_info">
            The total amount of (USD)<strong><span id="total_charge_small">$<%= @online_pay %></span></strong> is
            payable
            when you arrive. </p>
        </section>
      </header>
    </div>

  </div>

</div>

<script type="text/javascript">
  function updatePrice(sel) {
    var trav_no = sel.value;
    document.getElementById('tourist_no').innerHTML = trav_no;
    document.getElementById('vehicle_no').innerHTML = '1';
    var tran_price = document.getElementById('purchase_transport_price').value;
    var tick_price = document.getElementById('purchase_ticket_price').value;
    var tota_price = tick_price * trav_no;
    if (trav_no > 4){
      document.getElementById('vehicle_no').innerHTML = '2';
      tota_price = parseInt(tota_price) + parseInt(tran_price * 2);
    }
    else
      tota_price = parseInt(tota_price) + parseInt(tran_price);
    document.getElementById('total_charge').innerHTML = tota_price;
    document.getElementById('total_charge_small').innerHTML = tota_price;

  }
</script>



